<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com 'unsafe-eval'; style-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com 'unsafe-inline'; img-src 'self' data:; connect-src 'none'">
    <link rel="stylesheet" href="markdown-viewer.css">
    <!-- Use older, more stable versions of the libraries -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.12.3/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
    <!-- Load highlight.js with a simple CSS theme -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css"
        id="hljs-theme">

</head>

<body>

    <div class="version">v2025-07-03.8</div>

    <title>Markdown Viewer</title>

    <!-- 
    Functional Requirements:
    - Three-pane layout: Input, TOC, and Preview
    - Drag & drop markdown file support
    - Table of Contents generated from headings
    - Synchronized scrolling between TOC and preview
    - Dark/Light mode toggle
    - Fullscreen toggle
    - Content saved in local storage
    - Copy formatted HTML to clipboard
    - Mobile responsive design
    - Markdown syntax highlighting
    -->


    <div class="app-container" x-data="markdownViewer()" x-init="init()" @drop.prevent="handleDrop($event)"
        @dragover.prevent>
        <!-- Home Button -->
        <a href="index.html" class="home-btn">üè†</a>

        <!-- Full Screen Toggle -->
        <button @click="toggleFullscreen()" class="control-btn fullscreen-btn">
            <span x-text="isFullscreen ? 'üóó' : 'üóñ'"></span>
        </button>

        <!-- Dark/Light Toggle -->
        <button @click="toggleTheme()" class="control-btn theme-btn">
            <span x-text="isDark ? '‚òÄÔ∏è' : 'üåô'"></span>
        </button>

        <!-- Copy HTML Button -->
        <button @click="copyHtml()" class="control-btn copy-btn" title="Copy HTML">
            <span>üìã</span>
        </button>

        <!-- Main Layout -->
        <div class="markdown-container">
            <!-- Input Pane -->
            <div class="input-pane">
                <div class="pane-header">Markdown Input</div>
                <textarea x-model="markdownText" @input="updatePreview()"
                    placeholder="Type or drag & drop markdown here..." spellcheck="false"></textarea>
                <div class="file-drop-zone" x-show="isDragging" x-transition>
                    Drop markdown file here
                </div>
            </div>

            <!-- TOC Pane -->
            <div class="toc-pane">
                <div class="pane-header">Table of Contents</div>
                <div class="toc-content" x-html="tocHtml"></div>
            </div>

            <!-- Preview Pane -->
            <div class="preview-pane">
                <div class="pane-header">Preview</div>
                <div class="preview-content" x-html="previewHtml" id="preview-content"></div>
            </div>
        </div>

        <!-- Success Toast -->
        <div class="toast" x-show="showToast" x-transition x-text="toastMessage"></div>
    </div>

    <div class="version">v2025-07-03.8</div>

    <script src="markdown-viewer.js"></script>
    <script src="shared/footer.js"></script>
</body>

</html>